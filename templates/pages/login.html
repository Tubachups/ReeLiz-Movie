{% extends './components/base.html' %}

{% block head %}
<title>ReeLiz - Login / Sign Up</title>
<link rel="stylesheet" href="{{ url_for('static', filename='styles/auth.css') }}">
{% endblock %}

{% block body %}
<div class="container py-5">
  <div class="row justify-content-center align-items-center min-vh-100 g-0">

    <!-- Login / Signup Container (Left Side) -->
    <div class="col-md-6 col-lg-5">
      <div class="card shadow-lg">
        <!-- Tabs on top (flush to top edge of card) -->

        <!-- Tabs on top-->
        <ul class="nav nav-tabs nav-fill" id="authTabs" role="tablist" style="margin-bottom: 0;">
          <li class="nav-item" role="presentation">
            <!-- Login tab-->
            <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button"
              role="tab" aria-controls="login" aria-selected="true">
              <i class="fa-solid fa-right-to-bracket me-1"></i> Login
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <!-- Sign up tab-->
            <button class="nav-link" id="signup-tab" data-bs-toggle="tab" data-bs-target="#signup" type="button"
              role="tab" aria-controls="signup" aria-selected="false">
              <i class="fa-solid fa-user-plus me-1"></i> Sign Up
            </button>
          </li>
        </ul>

        <div class="card-body px-4 pb-4 pt-3">
          <!-- ReeLiz Title below Tabs -->
          <div class="text-center mb-3">
            <h2 class="fw-bold mb-1">ReeLiz</h2>
            <p class="text-muted" id="tabSubtitle">Welcome back!</p>
          </div>

          <!-- Error/Success Messages -->
          {% if error %}
          <div class="alert alert-danger alert-dismissible fade show" role="alert">
            {{ error }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
          {% endif %}
          {% if success %}
          <div class="alert alert-success alert-dismissible fade show" role="alert">
            {{ success }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
          {% endif %}

          <!-- Tabs Content -->
          <div class="tab-content" id="authTabsContent">
            <!-- Login Tab -->
            <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
              <form id="loginForm" method="POST" action="{{ url_for('login') }}">
                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="loginUsername" name="username"
                    placeholder="Username" required>
                  <label for="loginUsername"><i class="fa-regular fa-user me-1"></i> Username</label>
                </div>
                <div class="form-floating mb-3">
                  <input type="password" class="form-control" id="loginPassword" name="password" placeholder="Password"
                    required>
                  <label for="loginPassword"><i class="fa-solid fa-lock me-1"></i> Password</label>
                </div>
                <button type="submit" class="btn btn-ghost w-100 py-2">Login</button>
              </form>

              <div class="text-center mt-4">
                <a href="#" class="text-decoration-none">Forgot password?</a>
              </div>
            </div>

            <!-- Sign Up Tab -->
            <div class="tab-pane fade" id="signup" role="tabpanel" aria-labelledby="signup-tab">
              <form id="signupForm" method="POST" action="{{ url_for('signup') }}">
                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="signupUsername" name="username" placeholder="Username"
                    required>
                  <label for="signupUsername"><i class="fa-regular fa-user me-1"></i> Username</label>
                </div>
                <div class="form-floating mb-3">
                  <input type="email" class="form-control" id="signupEmail" name="email"
                    placeholder="name@example.com" required>
                  <label for="signupEmail"><i class="bi bi-envelope-at-fill me-1"></i> Email</label>
                </div>
                <div class="form-floating mb-3">
                  <input type="password" class="form-control" id="signupPassword" name="password" placeholder="Password"
                    required>
                  <label for="signupPassword"><i class="fa-solid fa-lock me-1"></i> Password</label>
                </div>
                <div class="form-floating mb-3">
                  <input type="password" class="form-control" id="signupConfirmPassword" name="confirm_password"
                    placeholder="Confirm Password" required>
                  <label for="signupConfirmPassword"><i class="fa-solid fa-key me-1"></i> Confirm Password</label>
                </div>
                <div class="mb-3 form-check">
                  <input type="checkbox" class="form-check-input" id="termsCheck" name="terms" required>
                  <label class="form-check-label" for="termsCheck">
                    I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal" class="text-decoration-none">terms and conditions</a>
                  </label>
                </div>
                <button type="submit" class="btn btn-ghost w-100 py-2">Sign Up</button>
              </form>
            </div>
          </div>

          <div class="text-center m-4">
            <a href="{{ url_for('landing') }}" class="btn btn-link text-decoration-none">
              <i class="fa-solid fa-arrow-left me-1"></i> Back to Home
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Image Container (Right Side) -->
    <div class="col-md-6 col-lg-5 d-none d-md-block">
      <div class="auth-image-container"></div>
    </div>

  </div>
</div>

<!-- Terms and Conditions Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-fullscreen-sm-down" style="max-width: 90vw;">
    <div class="modal-content" style="max-height: 90vh;">
      <div class="modal-header bg-primary text-white flex-shrink-0">
        <h5 class="modal-title" id="termsModalLabel">
          <i class="fa-solid fa-file-contract me-2"></i>Terms and Conditions
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-3 p-md-4" style="overflow-y: auto;">
        <div class="terms-content">
          <h6 class="fw-bold text-primary mb-3">Welcome to ReeLiz Movie Booking Service</h6>
          
          <div class="mt-3">
            <h6 class="fw-bold">1. Acceptance of Terms</h6>
            <p class="mb-2">By creating an account and using ReeLiz, you agree to be bound by these Terms and Conditions. If you do not agree to these terms, please do not use our service.</p>
          </div>

          <div class="mt-3">
            <h6 class="fw-bold">2. Account Registration</h6>
            <p class="mb-2">You must provide accurate and complete information during registration. You are responsible for maintaining the confidentiality of your account credentials and for all activities that occur under your account.</p>
          </div>

          <div class="mt-3">
            <h6 class="fw-bold">3. Booking and Payments</h6>
            <ul class="mb-2">
              <li>All ticket bookings are subject to availability</li>
              <li>Prices are displayed in Philippine Peso (â‚±)</li>
              <li>Payment must be completed to confirm your booking</li>
              <li>Once confirmed, your booking ticket can be sent via email or can be directly download</li>
              <li>Please arrive at least 15 minutes before showtime</li>
            </ul>
          </div>

          <div class="mt-3">
            <h6 class="fw-bold">4. Cancellation and Refund Policy</h6>
            <p class="mb-2">Tickets are non-refundable once purchased. However, you may request a cancellation at least 2 hours before the scheduled showtime for a refund consideration. Refunds are processed within 2-3 business days.</p>
          </div>

          <div class="mt-3">
            <h6 class="fw-bold">5. Cinema Rules</h6>
            <ul class="mb-2">
              <li>Outside food and beverages are permitted but maintain cleanliness</li>
              <li>Maintain silence during the movie screening</li>
              <li>Recording or photography inside the cinema is strictly prohibited</li>
              <li>Management reserves the right to refuse entry or remove patrons who violate cinema rules</li>
            </ul>
          </div>

          <div class="mt-3">
            <h6 class="fw-bold">6. Age Restrictions</h6>
            <p class="mb-2">Certain movies may have age restrictions (G, PG, R-13, R-16, R-18). Valid ID may be required for age-restricted films. Parents/guardians are responsible for ensuring minors watch age-appropriate content.</p>
          </div>

          <div class="mt-3">
            <h6 class="fw-bold">7. Privacy and Data Protection</h6>
            <p class="mb-2">We collect and process your personal information in accordance with our Privacy Policy. Your data is used solely for booking management and service improvement. We do not share your information with third parties without your consent.</p>
          </div>

          <div class="mt-3">
            <h6 class="fw-bold">8. Limitation of Liability</h6>
            <p class="mb-2">ReeLiz is not liable for any indirect, incidental, or consequential damages arising from the use of our service. We reserve the right to modify showtimes, cancel screenings, or close cinemas due to unforeseen circumstances.</p>
          </div>

          <div class="mt-3">
            <h6 class="fw-bold">9. Changes to Terms</h6>
            <p class="mb-2">We reserve the right to modify these Terms and Conditions at any time. Continued use of the service after changes constitutes acceptance of the modified terms.</p>
          </div>

          <div class="mt-3 p-3 bg-light rounded">
            <h6 class="fw-bold text-primary">Contact Us</h6>
            <p class="mb-0">If you have questions about these Terms and Conditions, please contact us through our Contact page or email us at support@reeliz.com</p>
          </div>
        </div>
      </div>
      <div class="modal-footer flex-shrink-0">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="document.getElementById('termsCheck').checked = true;">
          I Agree
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  /* Force modal to stay centered in viewport, not page */
  #termsModal {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    overflow: hidden !important;
    display: none !important;
    align-items: center !important;
    justify-content: center !important;
  }
  
  #termsModal.show {
    display: flex !important;
  }
  
  #termsModal .modal-dialog {
    position: relative !important;
    margin: 0 !important;
    max-width: 90vw !important;
    width: auto !important;
  }
  
  /* Enable immediate smooth scroll for terms content */
  #termsModal .modal-body {
    scroll-behavior: auto !important;
    -webkit-overflow-scrolling: touch;
  }
  
  /* Ensure it stays centered on small screens too */
  @media (max-width: 575.98px) {
    #termsModal .modal-dialog {
      width: 100vw !important;
      height: 100vh !important;
      max-width: 100vw !important;
    }
  }
</style>

<script src="{{ url_for('static', filename='js/services/auth.js') }}"></script>
{% endblock %}